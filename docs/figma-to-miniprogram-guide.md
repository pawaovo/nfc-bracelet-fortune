# Figma 设计图转小程序页面实战指南

本文档总结了使用 Figma MCP 将设计图转换为微信小程序页面的完整流程、经验和注意事项。

---

## 📋 目录

1. [前期准备](#前期准备)
2. [设计图分析](#设计图分析)
3. [资源导出](#资源导出)
4. [代码实现](#代码实现)
5. [布局调整](#布局调整)
6. [配置化优化](#配置化优化)
7. [资源整理](#资源整理)
8. [质量检查](#质量检查)
9. [常见问题](#常见问题)
10. [最佳实践](#最佳实践)

---

## 1. 前期准备

### 1.1 工具准备

- ✅ Figma MCP 工具（用于导出设计图资源）
- ✅ 微信开发者工具
- ✅ 代码编辑器（VS Code）
- ✅ 设计图的 Figma 链接

### 1.2 设计图要求

- ✅ 设计图应该是完整的页面设计
- ✅ 设计图应该包含所有状态（正常、加载、错误等）
- ✅ 设计图应该标注清楚尺寸和间距
- ✅ 设计图应该提供所有需要的图片资源

### 1.3 技术栈确认

- ✅ uni-app 框架
- ✅ Vue 3 + TypeScript
- ✅ SCSS 样式
- ✅ rpx 响应式单位

---

## 2. 设计图分析

### 2.1 获取设计图基准尺寸

**关键步骤**：

1. 在 Figma 中查看设计图的画板尺寸（例如：430x932）
2. 记录设计图的基准宽度（通常是 430px 或 375px）
3. 确认小程序的基准宽度（750rpx）

**示例**：

```
设计图宽度：430px
小程序基准：750rpx
转换比例：750 / 430 = 1.744
```

### 2.2 分析页面结构

**分层分析**：

1. **背景层**：主背景、装饰背景
2. **内容层**：文字、图片、按钮
3. **交互层**：可点击元素、表单

**记录要点**：

- 每个元素的位置（top, left）
- 每个元素的尺寸（width, height）
- 元素之间的层级关系（z-index）
- 元素的对齐方式

### 2.3 识别可配置内容

**区分图片和文字**：

- ✅ **文字内容**：应该用代码实现，可随时修改
- ❌ **文字图片**：不推荐，无法修改内容

**区分装饰和内容**：

- **装饰性图片**：背景、图标、装饰元素
- **内容性图片**：产品图、详情图

---

## 3. 资源导出

### 3.1 使用 Figma MCP 导出资源

**命令示例**：

```bash
# 导出整个页面的资源
figma-mcp export --node-id=<节点ID> --output=./static/design-assets
```

### 3.2 导出的资源类型

- **PNG 图片**：背景、装饰、产品图
- **SVG 图标**：矢量图标、装饰元素
- **组件代码**：Figma MCP 生成的初始代码

### 3.3 资源导出注意事项

⚠️ **重要**：

1. 导出的资源文件名通常是哈希值，不易识别
2. 导出的代码可能包含冗余内容
3. 导出的尺寸可能需要调整

---

## 4. 代码实现

### 4.1 尺寸转换公式

**核心公式**：

```
rpx值 = 设计图px值 × (750 / 设计图基准宽度)
```

**示例**：

```
设计图基准宽度：430px
元素宽度：200px
转换后：200 × (750 / 430) = 349rpx
```

### 4.2 布局实现策略

**推荐使用绝对定位**：

```scss
.element {
  position: absolute;
  top: 100rpx; // 精确控制位置
  left: 50rpx;
  width: 300rpx;
  height: 200rpx;
  z-index: 10; // 控制层级
}
```

**为什么使用绝对定位**：

- ✅ 精确还原设计图位置
- ✅ 避免布局错位
- ✅ 便于调整层级关系

### 4.3 文字实现

**使用 `<text>` 组件，不要用图片**：

```vue
<!-- ✅ 正确：使用文字组件 -->
<text class="title">{{ config.texts.title }}</text>

<!-- ❌ 错误：使用文字图片 -->
<image src="title-image.png" />
```

### 4.4 图片实现

**使用配置化路径**：

```vue
<!-- ✅ 正确：使用配置引用 -->
<image :src="config.images.background" />

<!-- ❌ 错误：硬编码路径 -->
<image src="../../static/bg.png" />
```

---

## 5. 布局调整

### 5.1 初始实现后的常见问题

1. **背景图片不完全覆盖**
   - 检查图片尺寸和容器尺寸
   - 调整 `mode` 属性（`scaleToFill`, `aspectFill`）

2. **元素位置偏移**
   - 重新计算 rpx 值
   - 检查父容器的定位方式

3. **层级关系错误**
   - 调整 `z-index` 值
   - 确保父容器的 `position` 正确

### 5.2 微调技巧

**小幅度调整**：

```scss
// 每次调整 10-20rpx，观察效果
top: 100rpx; // 初始值
top: 120rpx; // 下移 20rpx
```

**整体移动**：

```scss
// 需要整体下移时，同时调整所有相关元素
.section-1 {
  top: 100rpx;
} // 原值
.section-2 {
  top: 300rpx;
} // 原值

// 整体下移 20rpx
.section-1 {
  top: 120rpx;
} // +20rpx
.section-2 {
  top: 320rpx;
} // +20rpx
```

### 5.3 适配小程序特殊区域

**胶囊按钮区域**：

- 小程序右上角有固定的胶囊按钮
- 需要避免内容被遮挡
- 通常需要下移顶部内容

**安全区域**：

- 考虑不同机型的安全区域
- 底部按钮要留出足够间距

---

## 6. 配置化优化

### 6.1 创建配置文件

**文件结构**：

```
pages/
└── page-name/
    ├── index.vue       # 页面主文件
    ├── config.ts       # 配置文件 ⭐
    └── README.md       # 使用说明
```

### 6.2 配置文件内容

**完整示例**：

```typescript
export interface PageTheme {
  name: string;

  // 图片资源配置
  images: {
    background: string;
    icon: string;
    // ... 其他图片
  };

  // 文字内容配置
  texts: {
    title: string;
    subtitle: string;
    description: string;
    // ... 其他文字
  };

  // 颜色配置（可选）
  colors?: {
    primary?: string;
    secondary?: string;
  };
}

export const defaultTheme: PageTheme = {
  name: '默认主题',
  images: {
    background: '../../static/pages/page-name/bg.png',
    // ...
  },
  texts: {
    title: '标题文字',
    // ...
  },
};

export function getTheme(name: string = 'default'): PageTheme {
  return themes[name] || defaultTheme;
}
```

### 6.3 配置化的好处

- ✅ 文字内容可随时修改
- ✅ 图片资源易于替换
- ✅ 支持多主题切换
- ✅ 代码结构清晰
- ✅ 便于维护和扩展

---

## 7. 资源整理

### 7.1 目录结构规范

**推荐结构**：

```
static/
├── pages/
│   ├── bind/              # 绑定页面资源
│   │   ├── bg-main.png
│   │   ├── bg-stars.png
│   │   └── button-bg.png
│   ├── profile/           # 个人信息页面资源
│   └── fortune/           # 运势页面资源
├── fonts/                 # 全局字体
└── logo.png               # 全局Logo
```

### 7.2 文件命名规范

**命名原则**：

- 使用小写字母和连字符（kebab-case）
- 名称要具有描述性
- 同类资源使用统一前缀

**示例**：

```
✅ bg-main.png          # 主背景
✅ bg-stars.png         # 星空背景
✅ button-bg.png        # 按钮背景
✅ icon-status.svg      # 状态图标
✅ detail-image-1.png   # 详情图片1

❌ 0a490b57...png       # 哈希命名（不推荐）
❌ image1.png           # 名称不明确
❌ 背景图.png           # 中文命名（不推荐）
```

### 7.3 资源清理

**清理步骤**：

1. 删除 Figma MCP 导出的原始哈希文件
2. 删除未使用的资源文件
3. 删除重复的资源文件
4. 更新配置文件中的路径

---

## 8. 质量检查

### 8.1 代码检查清单

- [ ] 无硬编码的图片路径
- [ ] 无硬编码的文字内容
- [ ] 无重复代码
- [ ] 无冗余代码
- [ ] 无未使用的函数或变量
- [ ] 类型定义完整
- [ ] 注释清晰完整

### 8.2 功能检查清单

- [ ] 页面正常显示
- [ ] 布局与设计图一致
- [ ] 文字内容可修改
- [ ] 图片资源可替换
- [ ] 交互功能正常
- [ ] 错误处理完善
- [ ] 加载状态正确

### 8.3 性能检查清单

- [ ] 图片资源已压缩
- [ ] 无不必要的网络请求
- [ ] 无内存泄漏
- [ ] 页面加载速度快

---

## 9. 常见问题

### 9.1 布局问题

**Q1：背景图片显示不完整？**

```scss
// 解决方案：调整图片尺寸和定位
.bg-image {
  position: absolute;
  top: -5%; // 向上扩展
  left: -50%; // 向左扩展
  width: 160%; // 增加宽度
  height: 110%; // 增加高度
}
```

**Q2：元素位置与设计图不一致？**

```
1. 重新确认设计图基准尺寸
2. 重新计算 rpx 转换值
3. 检查父容器的定位方式
4. 检查是否有其他样式影响
```

**Q3：层级关系错误，元素被遮挡？**

```scss
// 解决方案：调整 z-index
.background {
  z-index: 1;
} // 背景层
.content {
  z-index: 100;
} // 内容层
.overlay {
  z-index: 200;
} // 覆盖层
```

### 9.2 资源问题

**Q4：图片资源过大，加载慢？**

```
解决方案：
1. 使用图片压缩工具（TinyPNG）
2. 使用 WebP 格式
3. 使用 CDN 加载
```

**Q5：SVG 图标显示异常？**

```
解决方案：
1. 检查 SVG 代码是否完整
2. 使用 PNG 替代（如果必要）
3. 调整 SVG 的 viewBox 属性
```

---

## 10. 最佳实践

### 10.1 开发流程

```
1. 分析设计图 → 记录尺寸和结构
2. 导出资源 → 使用 Figma MCP
3. 创建页面 → 实现基础布局
4. 调整布局 → 精确还原设计
5. 配置化 → 提取配置文件
6. 整理资源 → 规范命名和目录
7. 质量检查 → 代码和功能测试
8. 文档编写 → 使用说明和注释
```

### 10.2 代码规范

```typescript
// ✅ 使用配置化
const config = getTheme('default');
<text>{{ config.texts.title }}</text>

// ✅ 使用 TypeScript 类型
interface PageConfig {
  images: Record<string, string>;
  texts: Record<string, string>;
}

// ✅ 添加注释
// 更新时间显示
const updateTime = () => {
  // ...
};
```

### 10.3 资源管理

```
1. 按页面分类存放资源
2. 使用规范的文件命名
3. 及时清理无用资源
4. 维护资源映射文档
5. 使用版本控制管理资源
```

### 10.4 文档维护

```
必须维护的文档：
1. 页面使用说明（README.md）
2. 配置文件说明（config.ts 注释）
3. 资源映射文档（RESOURCE_MAP.md）
4. 开发经验总结（本文档）
```

---

## 📝 总结

### 核心要点

1. ✅ **精确转换尺寸**：使用正确的转换公式
2. ✅ **配置化管理**：所有内容都应该可配置
3. ✅ **规范化命名**：资源文件使用清晰的命名
4. ✅ **文字用代码**：不要使用文字图片
5. ✅ **质量检查**：确保无冗余和垃圾代码

### 成功标准

- ✅ 页面布局与设计图完全一致
- ✅ 所有文字内容可随时修改
- ✅ 所有图片资源可轻松替换
- ✅ 代码结构清晰，易于维护
- ✅ 资源文件规范，易于管理

### 避免的错误

- ❌ 硬编码图片路径和文字内容
- ❌ 使用文字图片代替文字组件
- ❌ 使用哈希值命名资源文件
- ❌ 资源文件散落在各处
- ❌ 缺少配置文件和文档

---

**文档版本**: v1.0  
**最后更新**: 2025-01-15  
**适用项目**: 手链运势微信小程序  
**维护团队**: 开发团队
