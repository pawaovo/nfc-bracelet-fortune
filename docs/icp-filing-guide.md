# ICP备案申请指南

## 📋 目录

- [一、备案概述](#一备案概述)
- [二、备案前准备](#二备案前准备)
- [三、备案申请流程](#三备案申请流程)
- [四、常见问题](#四常见问题)
- [五、备案后操作](#五备案后操作)

---

## 一、备案概述

### 什么是ICP备案？

ICP备案是**互联网信息服务备案**，是中国大陆地区网站和小程序上线的必要条件。

### 为什么需要备案？

- ✅ **微信小程序上架必须**：没有备案号无法提交审核
- ✅ **合法合规**：符合国家互联网管理规定
- ✅ **域名解析**：备案后域名才能正常解析

### 备案类型选择

| 类型         | 适用对象         | 优点             | 缺点         | 推荐度     |
| ------------ | ---------------- | ---------------- | ------------ | ---------- |
| **个人备案** | 个人开发者       | 简单快速，材料少 | 不能商业化   | ⭐⭐⭐⭐⭐ |
| **企业备案** | 有营业执照的公司 | 可以商业化       | 需要营业执照 | ⭐⭐⭐⭐   |

**本项目推荐：个人备案**（因为是免费娱乐服务，不涉及商业交易）

---

## 二、备案前准备

### 1. 购买域名

#### 推荐域名

基于本项目特点，推荐以下域名（需检查是否可用）：

```
✅ 推荐：
- nfc-fortune.com
- bracelet-fortune.cn
- lucky-bracelet.com
- nfc-luck.cn
- fortune-nfc.com

❌ 避免使用：
- suanming（算命）
- zhanbu（占卜）
- mixin（迷信）
等敏感词汇
```

#### 购买渠道

| 服务商     | 价格        | 推荐度     | 备注           |
| ---------- | ----------- | ---------- | -------------- |
| **阿里云** | 50-100元/年 | ⭐⭐⭐⭐⭐ | 备案流程最成熟 |
| **腾讯云** | 50-100元/年 | ⭐⭐⭐⭐⭐ | 与微信同属腾讯 |
| **华为云** | 50-100元/年 | ⭐⭐⭐⭐   | 价格实惠       |

**购买步骤：**

1. 访问服务商官网（例如：https://www.aliyun.com）
2. 搜索"域名注册"
3. 输入想要的域名，检查是否可用
4. 加入购物车，完成支付
5. 实名认证（上传身份证，1-3天审核）

---

### 2. 购买服务器

#### 推荐配置

| 配置项       | 推荐值           | 说明            |
| ------------ | ---------------- | --------------- |
| **CPU**      | 2核              | 满足基本需求    |
| **内存**     | 4GB              | 运行数据库+后端 |
| **硬盘**     | 40GB             | 系统盘          |
| **带宽**     | 1-3Mbps          | 小程序流量不大  |
| **操作系统** | Ubuntu 22.04 LTS | 稳定易用        |

#### 购买渠道

| 服务商        | 价格         | 新用户优惠 | 推荐度     |
| ------------- | ------------ | ---------- | ---------- |
| **阿里云ECS** | 300-500元/月 | 首年1折    | ⭐⭐⭐⭐⭐ |
| **腾讯云CVM** | 300-500元/月 | 首年1折    | ⭐⭐⭐⭐⭐ |
| **华为云ECS** | 300-500元/月 | 首年1折    | ⭐⭐⭐⭐   |

**购买建议：**

- 选择与域名同一服务商（备案更方便）
- 选择"按量付费"或"包年包月"
- 地域选择：华北（北京）或华东（上海）

---

### 3. 准备备案材料

#### 个人备案材料清单

- [ ] **身份证正反面照片**（清晰、完整）
- [ ] **手机号码**（用于接收验证码）
- [ ] **电子邮箱**
- [ ] **居住地址**（详细到门牌号）
- [ ] **域名证书**（购买域名后，服务商提供）
- [ ] **服务器信息**（IP地址、服务商名称）

#### 企业备案材料清单

- [ ] **营业执照副本**（扫描件或照片）
- [ ] **法人身份证正反面照片**
- [ ] **网站负责人身份证正反面照片**
- [ ] **网站负责人手机号**
- [ ] **企业公章**（用于盖章）
- [ ] **域名证书**
- [ ] **服务器信息**

---

## 三、备案申请流程

### 第1步：登录微信公众平台

1. 访问：https://mp.weixin.qq.com
2. 使用小程序管理员账号登录
3. 进入：**设置** → **小程序备案**

---

### 第2步：填写主体信息

#### 个人备案示例

```
备案类型：个人

主体信息：
- 姓名：张三
- 证件类型：身份证
- 证件号码：110101199001011234
- 手机号：13800138000
- 电子邮箱：zhangsan@example.com
- 通信地址：北京市朝阳区xxx街道xxx号xxx室
```

**注意事项：**

- 手机号必须是本人实名认证的
- 地址必须详细到门牌号
- 邮箱建议使用常用邮箱（QQ、163、Gmail等）

---

### 第3步：填写网站信息

```
网站名称：个人运势娱乐服务
（避免使用"算命"、"占卜"等敏感词）

网站域名：nfc-fortune.com
（你购买的域名）

服务器IP：123.456.789.100
（你购买的服务器公网IP）

服务内容：生活服务 - 综合生活服务

网站描述：
提供基于NFC手链的个性化运势娱乐服务，
内容仅供娱乐参考，不涉及封建迷信。
```

**网站名称命名规范：**

- ✅ 个人运势娱乐服务
- ✅ 个性化生活服务平台
- ✅ 趣味运势分享
- ❌ 算命占卜服务（敏感词）
- ❌ 风水预测平台（敏感词）

---

### 第4步：填写负责人信息

```
负责人姓名：张三（与主体信息一致）
负责人手机：13800138000
负责人邮箱：zhangsan@example.com
```

---

### 第5步：上传材料

#### 需要上传的文件

1. **身份证正面照片**
   - 格式：JPG/PNG
   - 大小：< 2MB
   - 要求：清晰、完整、无遮挡

2. **身份证反面照片**
   - 格式：JPG/PNG
   - 大小：< 2MB
   - 要求：清晰、完整、无遮挡

3. **真实性核验单**
   - 微信会提供模板
   - 下载后打印
   - 手写签名
   - 拍照上传

4. **域名证书**
   - 登录域名服务商后台下载
   - 阿里云：域名控制台 → 域名列表 → 管理 → 域名证书
   - 腾讯云：域名管理 → 我的域名 → 域名证书

---

### 第6步：提交审核

1. **检查所有信息**
   - 姓名、身份证号无误
   - 手机号、邮箱正确
   - 域名、服务器IP正确
   - 材料已全部上传

2. **阅读并同意备案协议**

3. **点击"提交备案"**

4. **等待微信平台初审**
   - 时间：1-2个工作日
   - 结果：通过短信和邮件通知

---

### 第7步：短信核验（重要！）

#### 收到工信部短信

```
【工信部】您的备案申请已提交，
请在24小时内访问 https://beian.miit.gov.cn
进行短信核验，验证码：123456
```

#### 核验步骤

1. **访问工信部网站**
   - 网址：https://beian.miit.gov.cn
   - 点击"短信核验"

2. **填写核验信息**
   - 手机号：13800138000（收到短信的手机号）
   - 证件号码：110101199001011234（身份证号）
   - 验证码：123456（短信中的验证码）

3. **提交核验**
   - 点击"提交"
   - 显示"核验成功"

**⚠️ 重要提醒：**

- 必须在**24小时内**完成核验
- 超时未核验，备案申请会被退回
- 如果没收到短信，联系服务商客服

---

### 第8步：等待通管局审核

1. **审核时间**
   - 通常：7-10个工作日
   - 最长：20个工作日

2. **审核结果**
   - 通过：收到备案号（例如：京ICP备12345678号）
   - 拒绝：收到拒绝原因，修改后重新提交

3. **查询进度**
   - 登录微信公众平台查看
   - 或访问工信部网站查询

---

## 四、常见问题

### Q1: 备案需要多长时间？

**A:** 通常1-20个工作日，具体时间取决于：

- 微信平台初审：1-2天
- 短信核验：24小时内完成
- 通管局审核：7-10天（最长20天）

---

### Q2: 备案期间网站能访问吗？

**A:**

- 备案期间，域名**不能解析**到服务器
- 可以使用IP地址访问（仅用于测试）
- 备案通过后，才能正式使用域名

---

### Q3: 备案被拒绝怎么办？

**A:** 常见拒绝原因及解决方案：

| 拒绝原因       | 解决方案                 |
| -------------- | ------------------------ |
| 网站名称不规范 | 修改为"个人运势娱乐服务" |
| 材料不清晰     | 重新拍照上传             |
| 手机号未实名   | 使用实名认证的手机号     |
| 地址不详细     | 补充详细地址（到门牌号） |
| 未完成短信核验 | 24小时内完成核验         |

---

### Q4: 个人备案可以商业化吗？

**A:**

- ❌ 不能涉及在线支付、商品销售
- ✅ 可以展示广告（需符合规定）
- ✅ 可以提供免费服务
- 本项目是免费娱乐服务，符合个人备案要求

---

### Q5: 备案后需要做什么？

**A:**

1. 在网站底部添加备案号
2. 备案号链接到工信部网站
3. 每年进行备案信息核查
4. 如有变更，及时更新备案信息

---

## 五、备案后操作

### 1. 在小程序中添加备案号

备案通过后，需要在小程序底部添加备案号。

**示例：**

```
京ICP备12345678号
```

**添加位置：**

- 设置页面底部
- 关于页面底部

---

### 2. 配置服务器域名

备案通过后，在微信公众平台配置服务器域名：

1. 登录微信公众平台
2. 进入：**开发** → **开发管理** → **开发设置**
3. 找到"服务器域名"
4. 添加：
   ```
   request合法域名：
   - https://nfc-fortune.com
   - https://ark.cn-beijing.volces.com（AI服务）
   ```

---

### 3. 修改代码配置

备案通过后，修改生产环境API地址：

**文件：** `apps/wx-app/src/api/config.ts`

```typescript
export const API_CONFIG = {
  // 开发环境API地址（开发者工具）
  DEV_BASE_URL: 'http://localhost:3000',
  // 真机调试API地址（电脑局域网IP）
  REAL_DEVICE_BASE_URL: 'http://192.168.31.217:3000',
  // 生产环境API地址（⚠️ 修改为你的实际域名）
  PROD_BASE_URL: 'https://nfc-fortune.com', // 替换为你的域名
  TIMEOUT: 30000,
  VERSION: 'v1',
};
```

---

### 4. 部署后端服务

参考文档：`docs/production-deployment-guide.md`

---

## 📞 联系支持

### 微信官方

- **微信公众平台**：https://mp.weixin.qq.com
- **备案咨询**：微信公众平台客服

### 服务商客服

- **阿里云**：95187
- **腾讯云**：95716
- **华为云**：4000-955-988

### 工信部

- **备案管理系统**：https://beian.miit.gov.cn
- **咨询电话**：010-66411166

---

## ✅ 备案检查清单

在提交备案前，请确认：

- [ ] 域名已购买并实名认证
- [ ] 服务器已购买
- [ ] 身份证照片清晰完整
- [ ] 手机号是本人实名认证的
- [ ] 邮箱可以正常接收邮件
- [ ] 地址详细到门牌号
- [ ] 网站名称不含敏感词
- [ ] 真实性核验单已签名
- [ ] 域名证书已下载

---

**祝您备案顺利！** 🎉
