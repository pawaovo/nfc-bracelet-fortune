# ä¸“å±NFCæ‰‹é“¾è¿åŠ¿å¾®ä¿¡å°ç¨‹åº

ä¸€æ¬¾åŸºäºNFCæŠ€æœ¯çš„å¾®ä¿¡å°ç¨‹åºï¼Œå°†å®ä½“æ‰‹é“¾ä¸ä¸ªæ€§åŒ–è¿åŠ¿æœåŠ¡ç»“åˆï¼Œç”¨æˆ·é€šè¿‡æ‰‹æœºè§¦ç¢°NFCæ‰‹é“¾å³å¯å¿«é€Ÿè·å–ä¸“å±è¿åŠ¿ã€‚

## ğŸ¯ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œé€šè¿‡NFCæŠ€æœ¯å®ç°æ‰‹é“¾ä¸ç”¨æˆ·çš„ç»‘å®šï¼Œä¸ºç”¨æˆ·æä¾›ä¸ªæ€§åŒ–çš„æ¯æ—¥è¿åŠ¿æœåŠ¡ï¼Œå¹¶å¼•å¯¼ç”¨æˆ·å‰å¾€æŠ–éŸ³åº—é“ºè´­ä¹°æ‰‹é“¾å•†å“ã€‚

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯ (å¾®ä¿¡å°ç¨‹åº)

- **æ¡†æ¶**: uni-app (Vue 3 + Vite + TypeScript)
- **çŠ¶æ€ç®¡ç†**: Pinia
- **UIç»„ä»¶**: uView UI 2.x
- **æ„å»ºå·¥å…·**: Vite
- **æµ‹è¯•**: Vitest

### åç«¯ (APIæœåŠ¡)

- **æ¡†æ¶**: NestJS (Node.js + TypeScript)
- **æ•°æ®åº“**: PostgreSQL (è‡ªå»º)
- **ORM**: Prisma
- **è®¤è¯**: JWT + å¾®ä¿¡ç™»å½•
- **æ—¥å¿—**: Pino
- **æµ‹è¯•**: Jest

### å¼€å‘å·¥å…·

- **åŒ…ç®¡ç†**: pnpm workspaces (Monorepo)
- **ä»£ç è§„èŒƒ**: ESLint + Prettier
- **Gité’©å­**: husky + lint-staged
- **å®¹å™¨åŒ–**: Docker Compose (æœ¬åœ°å¼€å‘)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js >= 18.0.0
- pnpm >= 8.0.0
- Docker & Docker Compose (ç”¨äºæœ¬åœ°æ•°æ®åº“)

### å¤–éƒ¨æœåŠ¡å‡­è¯å‡†å¤‡

åœ¨å¼€å§‹å¼€å‘å‰ï¼Œè¯·å‡†å¤‡ä»¥ä¸‹æœåŠ¡å‡­è¯ï¼š

1. **å¾®ä¿¡å°ç¨‹åº**
   - AppID: ä»å¾®ä¿¡å…¬ä¼—å¹³å°è·å–
   - AppSecret: ä»å¾®ä¿¡å…¬ä¼—å¹³å°è·å–

2. **OpenAIå…¼å®¹API** (å¯é€‰ï¼Œç”¨äºAIè¿åŠ¿ç”Ÿæˆ)
   - API Key: ä»OpenAIæˆ–å…¶ä»–å…¼å®¹æœåŠ¡å•†è·å–
   - Base URL: APIæœåŠ¡åœ°å€

### å®‰è£…ä¾èµ–

```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–
pnpm install
```

### å¯åŠ¨æœ¬åœ°æ•°æ®åº“

```bash
# å¯åŠ¨PostgreSQLæ•°æ®åº“
docker-compose up -d

# ç­‰å¾…æ•°æ®åº“å¯åŠ¨å®Œæˆ
docker-compose logs -f postgres
```

### é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶åç«¯ç¯å¢ƒå˜é‡æ¨¡æ¿
cp apps/api/.env.example apps/api/.env

# ç¼–è¾‘ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œå¡«å…¥å®é™…çš„æœåŠ¡å‡­è¯
# ç‰¹åˆ«æ³¨æ„é…ç½®ï¼š
# - DATABASE_URL: PostgreSQLè¿æ¥å­—ç¬¦ä¸²
# - WECHAT_APP_ID: å¾®ä¿¡å°ç¨‹åºAppID
# - WECHAT_APP_SECRET: å¾®ä¿¡å°ç¨‹åºAppSecret
# - JWT_SECRET: JWTå¯†é’¥
# - OPENAI_API_KEY: OpenAI APIå¯†é’¥ (å¯é€‰)
```

### åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç”ŸæˆPrismaå®¢æˆ·ç«¯
pnpm --filter api prisma:generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
pnpm --filter api prisma:migrate

# å¡«å……ç§å­æ•°æ®
pnpm --filter api db:seed
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# åŒæ—¶å¯åŠ¨å‰åç«¯å¼€å‘æœåŠ¡å™¨
pnpm dev

# æˆ–è€…åˆ†åˆ«å¯åŠ¨
pnpm dev:wx    # å¯åŠ¨å¾®ä¿¡å°ç¨‹åºå¼€å‘æœåŠ¡å™¨
pnpm dev:api   # å¯åŠ¨åç«¯APIå¼€å‘æœåŠ¡å™¨
```

### å¾®ä¿¡å¼€å‘è€…å·¥å…·é…ç½®

1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. å¯¼å…¥é¡¹ç›®ï¼Œé€‰æ‹© `apps/wx-app` ç›®å½•
3. é…ç½®AppIDä¸ºä½ çš„å¾®ä¿¡å°ç¨‹åºAppID
4. å¼€å§‹å¼€å‘å’Œè°ƒè¯•

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ wx-app/          # uni-appå‰ç«¯åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ api/     # APIè¯·æ±‚æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ components/ # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/   # é¡µé¢æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ stores/  # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ utils/   # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ api/             # NestJSåç«¯åº”ç”¨
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ auth/    # è®¤è¯æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ fortunes/ # è¿åŠ¿æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ users/   # ç”¨æˆ·æ¨¡å—
â”‚       â”‚   â””â”€â”€ ...
â”‚       â”œâ”€â”€ prisma/      # æ•°æ®åº“Schemaå’Œç§å­æ•°æ®
â”‚       â””â”€â”€ ...
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ shared-types/    # å‰åç«¯å…±äº«ç±»å‹å®šä¹‰
â”œâ”€â”€ docs/                # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ docker-compose.yml   # æœ¬åœ°å¼€å‘æ•°æ®åº“
â””â”€â”€ ...
```

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm test

# è¿è¡Œå‰ç«¯æµ‹è¯•
pnpm test:wx

# è¿è¡Œåç«¯æµ‹è¯•
pnpm test:api
```

## ğŸ”§ ä»£ç è§„èŒƒ

```bash
# ä»£ç æ£€æŸ¥
pnpm lint

# è‡ªåŠ¨ä¿®å¤ä»£ç è§„èŒƒé—®é¢˜
pnpm lint:fix

# ä»£ç æ ¼å¼åŒ–
pnpm format
```

## ğŸ“¦ æ„å»º

```bash
# æ„å»ºæ‰€æœ‰åº”ç”¨
pnpm build

# æ„å»ºå¾®ä¿¡å°ç¨‹åº
pnpm build:wx

# æ„å»ºåç«¯API
pnpm build:api
```

## ğŸš€ éƒ¨ç½²

### å¾®ä¿¡å°ç¨‹åºéƒ¨ç½²

1. ä½¿ç”¨ `pnpm build:wx` æ„å»ºå°ç¨‹åº
2. ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸Šä¼ ä»£ç åŒ…
3. åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°æäº¤å®¡æ ¸

### åç«¯APIéƒ¨ç½²

1. é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
2. ä½¿ç”¨ `pnpm build:api` æ„å»ºåº”ç”¨
3. éƒ¨ç½²åˆ°æœåŠ¡å™¨å¹¶å¯åŠ¨æœåŠ¡
4. è¿è¡Œ `pnpm --filter api prisma:deploy` åº”ç”¨æ•°æ®åº“è¿ç§»

## ğŸ“š å¼€å‘æ–‡æ¡£

- [æ¶æ„è®¾è®¡æ–‡æ¡£](./architecture.md)
- [äº§å“éœ€æ±‚æ–‡æ¡£](./prd.md)
- [è¯¦ç»†å¼€å‘æ–‡æ¡£](./docs/storie/)

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚
